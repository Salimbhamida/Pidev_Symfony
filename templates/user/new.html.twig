{% extends 'base.html.twig' %}

{% block title %}New User{% endblock %}

{% block body %}
    <h1>Photo Profile</h1>

    {{ include('user/_form.html.twig') }}

    <button id="btnSpeak" class="btn btn-info" onclick="window.location.href='{{ path('app_portfolio_index') }}'">Next</button>
    <select id='voiceList' hidden>

            </select> <br><br>


            

            <script>

                var voiceList = document.querySelector('#voiceList');
                var btnSpeak = document.querySelector('#btnSpeak');
                var synth = window.speechSynthesis;
                var voices = [];

                PopulateVoices();
                if(speechSynthesis !== undefined){
                    speechSynthesis.onvoiceschanged = PopulateVoices;
                }

                btnSpeak.addEventListener('click', ()=> {
                    var txtInput= ("Welcome  to your portfolio");
                    var toSpeak = new SpeechSynthesisUtterance(txtInput);
                    var selectedVoiceName = voiceList.selectedOptions[0].getAttribute('data-name');
                    voices.forEach((voice)=>{
                        if(voice.name === selectedVoiceName){
                            toSpeak.voice = voice;
                        }
                    });
                    synth.speak(toSpeak);
                });

                function PopulateVoices(){
                    voices = synth.getVoices();
                    var selectedIndex = voiceList.selectedIndex < 0 ? 6 : voiceList.selectedIndex;
                    voiceList.innerHTML = '';
                    voices.forEach((voice)=>{
                        var listItem = document.createElement('option');
                        listItem.textContent = voice.name;
                        listItem.setAttribute('data-lang', voice.lang);
                        listItem.setAttribute('data-name', voice.name);
                        voiceList.appendChild(listItem);
                    });

                    voiceList.selectedIndex = selectedIndex;
                }
            </script>
{% endblock %}
